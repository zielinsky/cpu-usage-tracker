\hypertarget{cputracker_8c}{}\doxysection{cputracker.\+c File Reference}
\label{cputracker_8c}\index{cputracker.c@{cputracker.c}}
{\ttfamily \#include \char`\"{}cputracker.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}analyzer.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}printer.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}reader.\+h\char`\"{}}\newline
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structproc__stat}{proc\+\_\+stat}} $\ast$ \mbox{\hyperlink{cputracker_8c_a6d7b4993bb9144e4cab9f9c7420c996a}{get\+\_\+item\+\_\+from\+\_\+data\+\_\+buffer}} (void)
\begin{DoxyCompactList}\small\item\em Function getting item from data buffer. \end{DoxyCompactList}\item 
unsigned long $\ast$ \mbox{\hyperlink{cputracker_8c_a2b8f2341417ff6536dcfd85113bd3a5d}{get\+\_\+item\+\_\+from\+\_\+print\+\_\+buffer}} (void)
\begin{DoxyCompactList}\small\item\em Function getting item from print buffer. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{cputracker_8c_ac99b6069bf629214ce6258902739d613}{notify\+\_\+watchdog}} (int id)
\begin{DoxyCompactList}\small\item\em Notify the watchdog that thread is alive. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{cputracker_8c_aa1407f3b7f6dc9f7ba1c2049f33cfa14}{main\+\_\+test}} (void)
\begin{DoxyCompactList}\small\item\em Simple test function with asserts. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{cputracker_8c_a840291bc02cba5474a4cb46a9b9566fe}{main}} (void)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{cputracker_8c_ada75f380c42154c470e2e3c3431e428b}{g\+\_\+nproc}} = 0
\item 
pthread\+\_\+mutex\+\_\+t \mbox{\hyperlink{cputracker_8c_a1ea12f2cf7f8d6c55575a0fcdfaf25b3}{g\+\_\+data\+Buffer\+Mutex}} = PTHREAD\+\_\+\+MUTEX\+\_\+\+INITIALIZER
\item 
sem\+\_\+t \mbox{\hyperlink{cputracker_8c_ae4ab6859f08e8d192e332bcc0396aace}{g\+\_\+data\+Filled\+Space\+Semaphore}}
\item 
sem\+\_\+t \mbox{\hyperlink{cputracker_8c_abe340c3124d5bd13bbae74ca586ec052}{g\+\_\+data\+Left\+Space\+Semaphore}}
\item 
pthread\+\_\+mutex\+\_\+t \mbox{\hyperlink{cputracker_8c_a61bf1e5999a9da9e3ef534a10f2c3319}{g\+\_\+print\+Buffer\+Mutex}} = PTHREAD\+\_\+\+MUTEX\+\_\+\+INITIALIZER
\item 
sem\+\_\+t \mbox{\hyperlink{cputracker_8c_a65a12649958e4813753cdffd576cb282}{g\+\_\+print\+Filled\+Space\+Semaphore}}
\item 
sem\+\_\+t \mbox{\hyperlink{cputracker_8c_a1f1095a3fda9dda3517fabf56803f2e9}{g\+\_\+print\+Left\+Space\+Semaphore}}
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{cputracker_8c_a6d7b4993bb9144e4cab9f9c7420c996a}\label{cputracker_8c_a6d7b4993bb9144e4cab9f9c7420c996a}} 
\index{cputracker.c@{cputracker.c}!get\_item\_from\_data\_buffer@{get\_item\_from\_data\_buffer}}
\index{get\_item\_from\_data\_buffer@{get\_item\_from\_data\_buffer}!cputracker.c@{cputracker.c}}
\doxysubsubsection{\texorpdfstring{get\_item\_from\_data\_buffer()}{get\_item\_from\_data\_buffer()}}
{\footnotesize\ttfamily struct \mbox{\hyperlink{structproc__stat}{proc\+\_\+stat}} $\ast$ get\+\_\+item\+\_\+from\+\_\+data\+\_\+buffer (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Function getting item from data buffer. 

\begin{DoxyReturn}{Returns}
\mbox{\hyperlink{structproc__stat}{proc\+\_\+stat}} struct from data buffer 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{cputracker_8c_source_l00069}{69}} of file \mbox{\hyperlink{cputracker_8c_source}{cputracker.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00070\ \ \ \textcolor{keywordtype}{int}\ index\ =\ get\_semaphore\_value(\&g\_dataFilledSpaceSemaphore);}
\DoxyCodeLine{00071\ \ \ \textcolor{keywordflow}{return}\ g\_dataBuffer[index];}
\DoxyCodeLine{00072\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{cputracker_8c_a2b8f2341417ff6536dcfd85113bd3a5d}\label{cputracker_8c_a2b8f2341417ff6536dcfd85113bd3a5d}} 
\index{cputracker.c@{cputracker.c}!get\_item\_from\_print\_buffer@{get\_item\_from\_print\_buffer}}
\index{get\_item\_from\_print\_buffer@{get\_item\_from\_print\_buffer}!cputracker.c@{cputracker.c}}
\doxysubsubsection{\texorpdfstring{get\_item\_from\_print\_buffer()}{get\_item\_from\_print\_buffer()}}
{\footnotesize\ttfamily unsigned long $\ast$ get\+\_\+item\+\_\+from\+\_\+print\+\_\+buffer (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Function getting item from print buffer. 

\begin{DoxyReturn}{Returns}
\mbox{\hyperlink{structproc__stat}{proc\+\_\+stat}} struct from print buffer 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{cputracker_8c_source_l00079}{79}} of file \mbox{\hyperlink{cputracker_8c_source}{cputracker.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00080\ \ \ \textcolor{keywordtype}{int}\ index\ =\ get\_semaphore\_value(\&g\_printFilledSpaceSemaphore);}
\DoxyCodeLine{00081\ \ \ \textcolor{keywordflow}{return}\ g\_printBuffer[index];}
\DoxyCodeLine{00082\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{cputracker_8c_a840291bc02cba5474a4cb46a9b9566fe}\label{cputracker_8c_a840291bc02cba5474a4cb46a9b9566fe}} 
\index{cputracker.c@{cputracker.c}!main@{main}}
\index{main@{main}!cputracker.c@{cputracker.c}}
\doxysubsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{cputracker_8c_source_l00128}{128}} of file \mbox{\hyperlink{cputracker_8c_source}{cputracker.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00129\ \ \ \textcolor{keyword}{struct\ }sigaction\ action;}
\DoxyCodeLine{00130\ \ \ memset(\&action,\ 0,\ \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct}\ sigaction));}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00132\ \ \ \textcolor{keywordflow}{if}\ (get\_nproc(\&g\_nproc)\ ==\ -\/1)\ \{}
\DoxyCodeLine{00133\ \ \ \ \ exit(EXIT\_FAILURE);}
\DoxyCodeLine{00134\ \ \ \}}
\DoxyCodeLine{00135\ \ \ g\_nproc++;}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ BUFFER\_SIZE;\ i++)\ \{}
\DoxyCodeLine{00138\ \ \ \ \ g\_dataBuffer[i]\ =\ malloc((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long})g\_nproc\ *\ \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct}\ \mbox{\hyperlink{structproc__stat}{proc\_stat}}));}
\DoxyCodeLine{00139\ \ \ \ \ g\_printBuffer[i]\ =\ malloc((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long})g\_nproc\ *\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}));}
\DoxyCodeLine{00140\ \ \ \ \ \textcolor{keywordflow}{if}\ (g\_dataBuffer[i]\ ==\ NULL\ ||\ g\_printBuffer[i]\ ==\ NULL)\ \{}
\DoxyCodeLine{00141\ \ \ \ \ \ \ exit(EXIT\_FAILURE);}
\DoxyCodeLine{00142\ \ \ \ \ \}}
\DoxyCodeLine{00143\ \ \ \}}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00145\ \ \ \textcolor{keywordflow}{if}\ (sem\_init(\&g\_dataFilledSpaceSemaphore,\ 0,\ 0)\ ||}
\DoxyCodeLine{00146\ \ \ \ \ \ \ sem\_init(\&g\_dataLeftSpaceSemaphore,\ 0,\ BUFFER\_SIZE))\ \{}
\DoxyCodeLine{00147\ \ \ \ \ exit(EXIT\_FAILURE);}
\DoxyCodeLine{00148\ \ \ \}}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ \ \ \textcolor{keywordflow}{if}\ (sem\_init(\&g\_printFilledSpaceSemaphore,\ 0,\ 0)\ ||}
\DoxyCodeLine{00151\ \ \ \ \ \ \ sem\_init(\&g\_printLeftSpaceSemaphore,\ 0,\ BUFFER\_SIZE))\ \{}
\DoxyCodeLine{00152\ \ \ \ \ exit(EXIT\_FAILURE);}
\DoxyCodeLine{00153\ \ \ \}}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00155\ \ \ pthread\_create(\&readerThreadId,\ NULL,\ reader,\ NULL);}
\DoxyCodeLine{00156\ \ \ pthread\_create(\&analyzerThreadId,\ NULL,\ \mbox{\hyperlink{analyzer_8c_a60d1e2bdc5c39558234c421a071d6f1c}{analyzer}},\ NULL);}
\DoxyCodeLine{00157\ \ \ pthread\_create(\&printerThreadId,\ NULL,\ printer,\ NULL);}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00159\ \ \ action.sa\_handler\ =\ handler;}
\DoxyCodeLine{00160\ \ \ sigaction(SIGTERM,\ \&action,\ NULL);}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00162\ \ \ watchdog();}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00164\ \ \ pthread\_join(readerThreadId,\ NULL);}
\DoxyCodeLine{00165\ \ \ pthread\_join(analyzerThreadId,\ NULL);}
\DoxyCodeLine{00166\ \ \ pthread\_join(printerThreadId,\ NULL);}
\DoxyCodeLine{00167\ }
\DoxyCodeLine{00168\ \ \ pthread\_mutex\_destroy(\&g\_dataBufferMutex);}
\DoxyCodeLine{00169\ \ \ sem\_destroy(\&g\_dataFilledSpaceSemaphore);}
\DoxyCodeLine{00170\ \ \ sem\_destroy(\&g\_dataLeftSpaceSemaphore);}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00172\ \ \ pthread\_mutex\_destroy(\&g\_printBufferMutex);}
\DoxyCodeLine{00173\ \ \ sem\_destroy(\&g\_printFilledSpaceSemaphore);}
\DoxyCodeLine{00174\ \ \ sem\_destroy(\&g\_printLeftSpaceSemaphore);}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00176\ \ \ pthread\_mutex\_destroy(\&watchdogMutex);}
\DoxyCodeLine{00177\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ BUFFER\_SIZE;\ i++)\ \{}
\DoxyCodeLine{00178\ \ \ \ \ free(g\_dataBuffer[i]);}
\DoxyCodeLine{00179\ \ \ \ \ free(g\_printBuffer[i]);}
\DoxyCodeLine{00180\ \ \ \}}
\DoxyCodeLine{00181\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00182\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{cputracker_8c_aa1407f3b7f6dc9f7ba1c2049f33cfa14}\label{cputracker_8c_aa1407f3b7f6dc9f7ba1c2049f33cfa14}} 
\index{cputracker.c@{cputracker.c}!main\_test@{main\_test}}
\index{main\_test@{main\_test}!cputracker.c@{cputracker.c}}
\doxysubsubsection{\texorpdfstring{main\_test()}{main\_test()}}
{\footnotesize\ttfamily void main\+\_\+test (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Simple test function with asserts. 



Definition at line \mbox{\hyperlink{cputracker_8c_source_l00121}{121}} of file \mbox{\hyperlink{cputracker_8c_source}{cputracker.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00122\ \ \ \textcolor{keywordtype}{int}\ nproc;}
\DoxyCodeLine{00123\ \ \ \textcolor{keywordflow}{if}\ (get\_nproc(\&nproc)\ ==\ 0)\ \{}
\DoxyCodeLine{00124\ \ \ \ \ assert(nproc\ >=\ 1);}
\DoxyCodeLine{00125\ \ \ \}}
\DoxyCodeLine{00126\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{cputracker_8c_ac99b6069bf629214ce6258902739d613}\label{cputracker_8c_ac99b6069bf629214ce6258902739d613}} 
\index{cputracker.c@{cputracker.c}!notify\_watchdog@{notify\_watchdog}}
\index{notify\_watchdog@{notify\_watchdog}!cputracker.c@{cputracker.c}}
\doxysubsubsection{\texorpdfstring{notify\_watchdog()}{notify\_watchdog()}}
{\footnotesize\ttfamily void notify\+\_\+watchdog (\begin{DoxyParamCaption}\item[{int}]{id }\end{DoxyParamCaption})}



Notify the watchdog that thread is alive. 


\begin{DoxyParams}{Parameters}
{\em id} & Thread ID \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{cputracker_8c_source_l00089}{89}} of file \mbox{\hyperlink{cputracker_8c_source}{cputracker.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00090\ \ \ pthread\_mutex\_lock(\&watchdogMutex);}
\DoxyCodeLine{00091\ \ \ working[id]\ =\ 1;}
\DoxyCodeLine{00092\ \ \ pthread\_mutex\_unlock(\&watchdogMutex);}
\DoxyCodeLine{00093\ \}}

\end{DoxyCode}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{cputracker_8c_a1ea12f2cf7f8d6c55575a0fcdfaf25b3}\label{cputracker_8c_a1ea12f2cf7f8d6c55575a0fcdfaf25b3}} 
\index{cputracker.c@{cputracker.c}!g\_dataBufferMutex@{g\_dataBufferMutex}}
\index{g\_dataBufferMutex@{g\_dataBufferMutex}!cputracker.c@{cputracker.c}}
\doxysubsubsection{\texorpdfstring{g\_dataBufferMutex}{g\_dataBufferMutex}}
{\footnotesize\ttfamily pthread\+\_\+mutex\+\_\+t g\+\_\+data\+Buffer\+Mutex = PTHREAD\+\_\+\+MUTEX\+\_\+\+INITIALIZER}



Definition at line \mbox{\hyperlink{cputracker_8c_source_l00009}{9}} of file \mbox{\hyperlink{cputracker_8c_source}{cputracker.\+c}}.

\mbox{\Hypertarget{cputracker_8c_ae4ab6859f08e8d192e332bcc0396aace}\label{cputracker_8c_ae4ab6859f08e8d192e332bcc0396aace}} 
\index{cputracker.c@{cputracker.c}!g\_dataFilledSpaceSemaphore@{g\_dataFilledSpaceSemaphore}}
\index{g\_dataFilledSpaceSemaphore@{g\_dataFilledSpaceSemaphore}!cputracker.c@{cputracker.c}}
\doxysubsubsection{\texorpdfstring{g\_dataFilledSpaceSemaphore}{g\_dataFilledSpaceSemaphore}}
{\footnotesize\ttfamily sem\+\_\+t g\+\_\+data\+Filled\+Space\+Semaphore}



Definition at line \mbox{\hyperlink{cputracker_8c_source_l00010}{10}} of file \mbox{\hyperlink{cputracker_8c_source}{cputracker.\+c}}.

\mbox{\Hypertarget{cputracker_8c_abe340c3124d5bd13bbae74ca586ec052}\label{cputracker_8c_abe340c3124d5bd13bbae74ca586ec052}} 
\index{cputracker.c@{cputracker.c}!g\_dataLeftSpaceSemaphore@{g\_dataLeftSpaceSemaphore}}
\index{g\_dataLeftSpaceSemaphore@{g\_dataLeftSpaceSemaphore}!cputracker.c@{cputracker.c}}
\doxysubsubsection{\texorpdfstring{g\_dataLeftSpaceSemaphore}{g\_dataLeftSpaceSemaphore}}
{\footnotesize\ttfamily sem\+\_\+t g\+\_\+data\+Left\+Space\+Semaphore}



Definition at line \mbox{\hyperlink{cputracker_8c_source_l00011}{11}} of file \mbox{\hyperlink{cputracker_8c_source}{cputracker.\+c}}.

\mbox{\Hypertarget{cputracker_8c_ada75f380c42154c470e2e3c3431e428b}\label{cputracker_8c_ada75f380c42154c470e2e3c3431e428b}} 
\index{cputracker.c@{cputracker.c}!g\_nproc@{g\_nproc}}
\index{g\_nproc@{g\_nproc}!cputracker.c@{cputracker.c}}
\doxysubsubsection{\texorpdfstring{g\_nproc}{g\_nproc}}
{\footnotesize\ttfamily int g\+\_\+nproc = 0}



Definition at line \mbox{\hyperlink{cputracker_8c_source_l00007}{7}} of file \mbox{\hyperlink{cputracker_8c_source}{cputracker.\+c}}.

\mbox{\Hypertarget{cputracker_8c_a61bf1e5999a9da9e3ef534a10f2c3319}\label{cputracker_8c_a61bf1e5999a9da9e3ef534a10f2c3319}} 
\index{cputracker.c@{cputracker.c}!g\_printBufferMutex@{g\_printBufferMutex}}
\index{g\_printBufferMutex@{g\_printBufferMutex}!cputracker.c@{cputracker.c}}
\doxysubsubsection{\texorpdfstring{g\_printBufferMutex}{g\_printBufferMutex}}
{\footnotesize\ttfamily pthread\+\_\+mutex\+\_\+t g\+\_\+print\+Buffer\+Mutex = PTHREAD\+\_\+\+MUTEX\+\_\+\+INITIALIZER}



Definition at line \mbox{\hyperlink{cputracker_8c_source_l00014}{14}} of file \mbox{\hyperlink{cputracker_8c_source}{cputracker.\+c}}.

\mbox{\Hypertarget{cputracker_8c_a65a12649958e4813753cdffd576cb282}\label{cputracker_8c_a65a12649958e4813753cdffd576cb282}} 
\index{cputracker.c@{cputracker.c}!g\_printFilledSpaceSemaphore@{g\_printFilledSpaceSemaphore}}
\index{g\_printFilledSpaceSemaphore@{g\_printFilledSpaceSemaphore}!cputracker.c@{cputracker.c}}
\doxysubsubsection{\texorpdfstring{g\_printFilledSpaceSemaphore}{g\_printFilledSpaceSemaphore}}
{\footnotesize\ttfamily sem\+\_\+t g\+\_\+print\+Filled\+Space\+Semaphore}



Definition at line \mbox{\hyperlink{cputracker_8c_source_l00015}{15}} of file \mbox{\hyperlink{cputracker_8c_source}{cputracker.\+c}}.

\mbox{\Hypertarget{cputracker_8c_a1f1095a3fda9dda3517fabf56803f2e9}\label{cputracker_8c_a1f1095a3fda9dda3517fabf56803f2e9}} 
\index{cputracker.c@{cputracker.c}!g\_printLeftSpaceSemaphore@{g\_printLeftSpaceSemaphore}}
\index{g\_printLeftSpaceSemaphore@{g\_printLeftSpaceSemaphore}!cputracker.c@{cputracker.c}}
\doxysubsubsection{\texorpdfstring{g\_printLeftSpaceSemaphore}{g\_printLeftSpaceSemaphore}}
{\footnotesize\ttfamily sem\+\_\+t g\+\_\+print\+Left\+Space\+Semaphore}



Definition at line \mbox{\hyperlink{cputracker_8c_source_l00016}{16}} of file \mbox{\hyperlink{cputracker_8c_source}{cputracker.\+c}}.

